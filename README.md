# Malware-visual-analysis-system-v1.0
## 1.系统介绍
<p>本系统的设计思路是设计一种能够自动监控恶意代码的执行、生成控制流和数据流信息、自动关联分析和可视化辅助分析的系统。通过构建虚拟执行环境来提取恶意代码在网络行为方面的控制流和数据流信息，自动进行关联分析和可视化展示，并且支持基本的可视化辅助分析工作。其开发目的将网络行为方面的监控信息转化成易于分析的图形，降低恶意代码分析的复杂度。</p>
<p>该系统采用python-bottle模块作为web开发框架，后端数据库基于mysql，本系统默认数据库名为jingsai，数据库连接相关参数在main.py主文件中设置。运行该系统需安装requirements.txt中相关模块，并将数据库文件导入mysql服务器，后台默认账户admin/password</p>

## 2.使用说明
* 2.1功能介绍
  * 2.1.1 提交数据
    * 点击左侧菜单栏“任务管理”，选择“提交数据”选项
    * 在输入框中输入任务名，选择样本文件并点击上传
    * 文件格式说明：本系统接受样本监控模块生成的数据流和控制流文件，提交格式为文件格式为txt，文件名不得包含中文。
  * 2.1.2 处理中心
    * 点击左侧菜单栏“任务管理”，选择“处理中心”选项可查看已提交的任务
    * “处理中心”可执行提交新任务、查看已提交的任务、删除任务、查看样本文件等操作
    * 点击任务名可以进入该任务的数据分析界面
  * 2.1.3 数据分析
    * 数据分析界面为系统根据用户提交的样本文件生成的可视化分析模型，分为控制流部分和数据流部分
    * 控制流部分表示为树形结构，数据流部分表示为力导图结构，用户可根据定义的交互动作对恶意代码进行辅助分析
    * 页面顶部定义了“查看源文件”和“查看数据结构”按钮，便于用户查看原始数据
  * 2.1.4 用户管理
    * 点击左侧菜单栏“任务管理”，选择“用户管理”选项
    * “用户管理”界面可执行对用户的增、删、改、查。
* 2.2辅助分析
  * 2.2.1 高亮显示
    * 高亮显示主要涉及结点高亮和连线高亮。在控制流部分，鼠标悬停与节点或连线上方时，节点或连线呈绿色高亮状态。触发路径探索功能时，相关连线也会呈高亮状态突出显示路径。在数据流部分，鼠标悬停与节点上方会使节点呈红色高亮状态，同时也有路径探索高亮功能。
  * 2.2.2 拖拽折叠
    * 展开折叠功能主要相对于控制流部分而言，因为控制流部分定义为树形图，因此可以通过双击结点对该节点的所有子节点进行折叠隐藏，再次双击则将该节点的隐藏子节点展开。
    * 拖拽功能适用于力导图，力导图模式节点处于自由浮动状态，根据结点关系和重力关系自动成图。单击节点并按住鼠标移动可拖拽节点，松开鼠标节点位置固定，双击可解除锁定
  * 2.2.3 路径探索
    * 路径探索用于寻找数据节点的关系。点击控制路数据节点，则高亮显示由起始节点至该节点的整条路线，同时红色高亮该节点的出口方向。点击数据流节点则自动探索该节点要经过的其它节点，并将整条路径高亮显示。
    * 关联分析功能指用户可通过点击控制流部分的结点来对与本节点相关的用数据流表示的跳转条件进行数据流图的高亮索引
  * 2.2.4 信息提示
    * 提示框用于显示更加详细的节点信息。单击控制流节点（连线）或是数据流节点会在界面右下角弹出节点信息框，信息框的主要内容包括控制流节点代表的代码块地址、该代码块的出口地址、下一代码块的入口地址、到达该代码块满足的跳转条件，控制流连线（出发点）的出口地址、跳转条件，数据流节点的变量名及所在数据流信息。

### 3.不足及改进方向
  * 一是样本监控模块并没有在此系统之中，所以本系统难以独立运行
  * 二是系统比较脆弱，只是经过简单的单一样本测试，依然存在尚未发现的bug
  * 三是对样本代码格式依赖性较大
  * 开发方向：丰富互动交流、拓展辅助分析功能、增强健壮性、社区化……
